
<h1>movieテーブルとshowtimeテーブルを紐づけて、一日のスケジュールを作れるようにする。</h1>
movieを使って、映画と日付の登録をして、showtimeテーブルに登録できるようにする。
まずはshowtimesテーブルに全部手動で登録できるフォームを用意してみる。
<% @showtimes.each do | showtime |  %>
  <p><%= showtime.id %></p>
  <p><%= showtime.movie_id %></p>
  <p><%= showtime.screen_id %></p>
  <p><%= showtime.screening_time %></p>
<% end %>

<% @grouped_showtimes.each do |date, showtimes| %>
  <h2><%= date.strftime("%Y年%m月%d日 (%a)") %> の上映スケジュール</h2>
  <table border="1" style="width: 100%; border-collapse: collapse; text-align: left;">
    <thead>
    <tr>
      <th>ID</th>
      <th>映画タイトル</th>
      <th>スクリーンID</th>
      <th>上映時間</th>
    </tr>
    </thead>
    <tbody>
    <% showtimes.each do |showtime| %>
      <tr>
        <td><%= showtime.id %></td>
        <td><%= showtime.movie.name %></td> <!-- movie.title を取得 -->
        <td><%= showtime.screen_id %></td>
        <td><%= showtime.screening_time.strftime("%H:%M") %></td>
      </tr>
    <% end %>
    </tbody>
  </table>
<% end %>


<h1>Showtimeを作成する</h1>

<%= form_with(model: @showtime, url: admin_showtimes_path, method: :post, local: true) do |form| %>
  <%# if @showtime.errors.any? %>
<!--    <div style="color: red">-->
<!--      <h2><%#= pluralize(@showtime.errors.count, "error") %>が発生しました:</h2>-->
<!--      <ul>-->
        <%# @showtime.errors.full_messages.each do |message| %>
<!--          <li><%#= message %></li>-->
        <%# end %>
<!--      </ul>-->
<!--    </div>-->
  <%# end %>

  <div>
    <%= form.label :movie_id, "映画ID", style: "display: block" %>
    <%= form.number_field :movie_id, required: true %>
  </div>

  <div>
    <%= form.label :screen_id, "スクリーンID", style: "display: block" %>
    <%= form.number_field :screen_id, required: true %>
  </div>

  <div>
    <%= form.label :screening_time, "上映時間", style: "display: block" %>
    <%= form.datetime_select :screening_time, required: true %>
  </div>

  <div>
    <%= form.submit "Showtimeを作成", style: "margin-top: 20px;" %>
  </div>
<% end %>
